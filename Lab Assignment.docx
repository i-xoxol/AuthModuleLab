Lab Assignment: Secure Authentication in Python

Introduction

This lab is designed to provide you with hands-on experience in developing a secure authentication module in Python. You will learn how to implement essential security features, such as password hashing and salting, to protect user credentials. Additionally, you will practice writing unit tests to ensure the correctness and security of your code.

Objectives

By the end of this lab, you will be able to:
- Understand the importance of secure password storage.
- Implement password hashing and salting using Python's hashlib and os modules.
- Develop a set of unit tests to verify the functionality of your authentication module.
- Create a simple command-line interface for user registration and login.

Tasks

1.  Create a new Python file named `user.py` and define a `User` class with the following attributes:
    - `username`: The user's username.
    - `hpass`: The user's hashed password.
    - `salt`: The salt used to hash the password.

2.  Create a new Python file named `auth.py` and implement the following functions:
    - `get_salt(length)`: Generates a random salt of the specified length.
    - `get_hash(input_string)`: Hashes the input string using the SHA-256 algorithm.
    - `bytes_to_hex(byte_array)`: Converts a byte array to a hexadecimal string.
    - `user_to_json(user)`: Converts a `User` object to a JSON string.
    - `json_to_user(json_string)`: Converts a JSON string to a `User` object.
    - `find_user(user_list, username)`: Finds a user in a list of users by their username.
    - `save_users(user_list, filepath)`: Saves a list of users to a JSON file.
    - `load_users(filepath)`: Loads a list of users from a JSON file.

3.  Create a new Python file named `user_registration.py` and implement the following function:
    - `create_user(username, password)`: Creates a new `User` object with a hashed password and a random salt.

4.  Create a new Python file named `test_auth.py` and write unit tests for the following functions in `auth.py`:
    - `get_salt()`
    - `get_hash()`
    - `json_to_user()`
    - `user_to_json()`
    - `find_user()`
    - `save_load_users()`

5.  Create a new Python file named `main.py` and implement a command-line interface with the following options:
    - `1-login`: Prompts the user for their username and password and verifies their credentials.
    - `2-register`: Prompts the user for a new username and password and creates a new user account.
    - `3-exit`: Exits the program.

Submission

Submit all the Python files you created (`user.py`, `auth.py`, `user_registration.py`, `test_auth.py`, and `main.py`) in a single zip file.

Grading

Your lab will be graded based on the following criteria:
- Correct implementation of the `User` class.
- Correct implementation of the functions in `auth.py`.
- Correct implementation of the `create_user()` function in `user_registration.py`.
- Completeness and correctness of the unit tests in `test_auth.py`.
- Correct implementation of the command-line interface in `main.py`.
- Code quality, including readability, comments, and adherence to Python best practices.
